diff -ru binutils-2.31.1.orig/bfd/pef.c binutils-2.31.1/bfd/pef.c
--- binutils-2.31.1.orig/bfd/pef.c	2021-02-25 06:26:06.524301300 +0900
+++ binutils-2.31.1/bfd/pef.c	2021-02-25 06:36:23.543330154 +0900
@@ -797,7 +797,7 @@
 	  codepos += 4;
 	}
 
-      if ((codepos + 4) > codelen)
+      if ((codepos + 24) > codelen)
 	break;
 
       ret = bfd_pef_parse_function_stub (abfd, codebuf + codepos, 24, &sym_index);
